---
layout: post
title: Links and trojans and zipsploits, oh my!
date: '2010-03-31T21:25:00.002+11:00'
author: Stephen Bradshaw
tags:
- malware analysis
- incident response
- malicious pdf
modified_time: '2010-06-16T19:01:16.367+10:00'
blogger_id: tag:blogger.com,1999:blog-2318886372568084567.post-3087956561165515118
blogger_orig_url: http://www.thegreycorner.com/2010/03/links-and-trojans-and-zipsploits-oh-my.html
redirect_from: /2010/03/links-and-trojans-and-zipsploits-oh-my.html
---

A bit of a housekeeping post here, where I am just going to provide some links for cool stuff I have seen recently and provide some updates on some things mentioned in other blog posts.<br/><br/>First of all... <a href="http://grey-corner.blogspot.com/2010/03/uh-oh-trojan.html">the trojan</a>.  Im still planning to write a malware detection and analysis style post using it as an example, but when I actually started writing the thing it started to grow out of all proportion to what I initially expected, and I have been far too busy (lazy) recently to do the thing justice and finish it properly.  But its coming soon.  <br/><br/>If you were waiting on me to tell you how to get rid of the trojan, stick the commands I have provided below in a batch file and run it from a command line until:<br/><ul><li>the adobeupdatemanager.exe, osa.exe and MPSvc.exe processes are dead (you should see ERROR: The process "x" not found in the output from taskkill, and the processes will disappear from Task Manager or tasklist), AND</li><li> the files referenced are gone (they are hidden system files by default so set the appropriate view options in Windows Explorer).  </li></ul><br/>You may need to run it a few times (fast), or run it in a never ending loop (e.g. "for /L %a in (1,0,1) do killtrojan.bat" ) and CTRL-C to kill because the processes can restart each other pretty quickly, and you have to kill the process before deleting the files.<br/><br/>The commands for the batch file:<br/><br/><blockquote>attrib -S -H "C:\Program Files\Adobe\AdobeUpdateManager.exe"<br/>attrib -S -H "C:\Program Files\Microsoft Office\Office11\OSA.exe"<br/>attrib -S -H "C:\Program Files\Windows Defender\MPSvc.exe"<br/><br/>taskkill /IM adobeupdatemanager.exe /IM osa.exe /IM MPSvc.exe <br/><br/><br/>del "C:\Program Files\Windows Defender\MPSvc.exe"<br/>del "C:\Program Files\Adobe\AdobeUpdateManager.exe"<br/>del "C:\Program Files\Microsoft Office\Office11\OSA.exe"</blockquote><br/>There are a few registry entries as well which you can track down and delete if you wish (its not strictly necessary if the files are deleted) - but be careful of this if you are not familiar with the purpose of the registry keys in question.  Find the appropriate entries by searching for the process name using regedit, and delete as appropriate.  Google the entry or key name if you're not sure what it does before you delete.<br/><br/><br/>You can also just nuke the machine from orbit to get rid of the trojan ;)<br/><br/>Second, a (non-trojaned this time) version of the vulnerable version of BigAnt server to use to reproduce my <a href="http://grey-corner.blogspot.com/2010/01/seh-stack-based-windows-buffer-overflow.html">second exploit tutorial</a>?  Lincoln tells me that <a href="http://download.cnet.com/BigAnt-Office-Messenger/3000-2150_4-10815173.html">this is such a beast</a>.  I haven't tested it myself yet to confirm its vulnerable, which is why I havent linked it from the main tutorial myself yet, but if you're desperate to get going with that you can give that version a bash.  If it works for you let me know and I will update the tutorial with the link.<br/><br/>Thirdly, PDF exploiting with Didier Stevens!  Now malicious PDF documents are nothing new, but this method does not use an exploit, and instead makes use of inbuilt PDF functionality to run executable content from within a PDF.  Very cool.  <a href="http://blog.didierstevens.com/2010/03/29/escape-from-pdf/">Here</a> and <a href="http://blog.didierstevens.com/2010/03/31/escape-from-foxit-reader/">here</a>.<br/><br/>If you read the <a href="http://www.offensive-security.com/blog/">Offensive Security Blog</a> you may have seen the two part malicious zipfile exploit tutorial from <a href="http://www.corelan.be:8800/">Peter Van Eeckhoutte</a>.  If not, its posted <a href="http://www.corelan.be:8800/index.php/2010/03/27/quickzip-stack-bof-0day-a-box-of-chocolates/">here</a> on his blog in one big document.  Very cool, and what's more it covers off on a exploit with a lot of bad characters, which is simething I have been intending to do for a while in one of my own tutorials (so it saves me from having to write that myself  - Excellent ;) )<br/><br/>Fifthly, <a href="http://www.mysectools.com/">this</a> is an interesting looking site I found posted on the Internet Storm Center Diary.  Maybe a slightly more up to date replacement for <a href="http://sectools.org/">sectools.org</a>?