---
layout: post
title: Linkfest
date: '2010-02-09T18:20:00.002+11:00'
author: Stephen Bradshaw
tags:
- malware analysis
- shellcode
- links
- malicious pdf
modified_time: '2010-06-16T19:01:16.368+10:00'
blogger_id: tag:blogger.com,1999:blog-2318886372568084567.post-7958697726026368139
blogger_orig_url: http://www.thegreycorner.com/2010/02/linkfest.html
redirect_from: /2010/02/linkfest.html
---

To tide everyone over while I finish up writing part 5 of my exploit tutorials (which will hopefully be done by the end of this week), I have a number of interesting links that I have collected recently.<br/><br/>Didier Stevens has been up to some very interesting things recently with getting dlls loaded from memory (so a copy of the DLL does NOT have to be stored on the hard disk).  This has very interesting implications for those who are looking for a way to avoid leaving a trail that can be picked up by forensic investigation of the hard drive.  He has implementing this dll loading in shellcode and has also managed to create dll based versions of cmd.exe and regedit.exe.  I'll leave it up to you to ponder the possibilities/implications of this from a pen testing and/or incident response perspective. <a href="http://blog.didierstevens.com/2010/01/28/quickpost-shellcode-to-load-a-dll-from-memory/">Links</a> <a href="http://blog.didierstevens.com/2010/02/04/cmd-dll/">are</a> <a href="http://blog.didierstevens.com/2010/02/08/excel-with-cmd-dll-regedit-dll/">here</a>.<br/><br/>The <a href="http://www.joachim-bauch.de/tutorials/load_dll_memory.html">dll loading method</a> used by Didier is also an interesting reference, not least because of the detail it provides on the Windows PE format.<br/><br/><br/>I have already written about <a href="http://grey-corner.blogspot.com/2010/01/analysing-malicious-pdf-document.html">how to analyse a malicious pdf document</a> (and if you read that post you may want to know that the PDF tools from Didier Stevens have been <a href="http://blog.didierstevens.com/2010/01/13/quickpost-new-versions-of-pdfid-and-pdf-parser/">updated</a> since), but if you want more information on the topic I have since discovered a number <a href="http://isc.sans.org/diary.html?storyid=7867">of</a> <a href="http://isc.sans.org/diary.html?storyid=7903">other</a> <a href="http://isc.sans.org/diary.html?storyid=7906">references</a> that you might find interesting.<br/><br/>And if you want to analyse other document types such as Word documents, Excel documents, etc?  Well, you can try the strings method I mentioned im my PDF post, or you could refer to <a href="http://zeltser.com/reverse-malware/analyzing-malicious-documents.html%20">this</a> or <a href="http://blog.kiddaland.net/2009/07/antiword-for-office-2007/">this</a>.<br/><br/><br/>Everyones favorite network scanning tool <a href="http://nmap.org/">Nmap</a> (well, maybe its not everyones favorite tool, but its certainly mine) now has the ability to send UDP application level probes when UDP port scanning, giving a much greater chance of getting accurate results from a UDP scan.  Given that on the protocol level the correct response for an open port is... no response most UDP port scans can be unreliable.  Is that port really open, or is a firewall blocking our probes or the port unreachable responses?  Now NMap can send application level data for certain well known UDP services, which should trigger a UDP response at the application level if the associated services is running on the appropriate port.  Getting one of these responses gives you positibe proof that a port is actually open.  More information <a href="http://isc.sans.org/diary.html?storyid=8110">here</a>.<br/><br/>An <a href="http://bernardodamele.blogspot.com/2009/12/dep-bypass-with-setprocessdeppolicy.html">interesting post on bypassing DEP</a> that I ran across.<br/><br/>Last but not least, <span class="post-author vcard"><span class="fn">Richard Bejtlich (he who runs the <a href="http://searchnetworkingchannel.techtarget.com/tip/0,289483,sid100_gci1380476,00.html">Taosecurity blog</a>) has recently written an <a href="http://searchnetworkingchannel.techtarget.com/tip/0,289483,sid100_gci1380476,00.html">article</a> on how to test Snort using Metasploit.  Those who use the Snort IDS might be interested in using this method to find out just how well they have configured their Snort installation, but penetration testers might also be interested in turning this article on its head to see how they can launch attacks that will bypass an IDS.  I have done some testing on this myself using Snort as my guinea pig IDS, and I may write something up on this for a future blog entry.</span></span><br/><span class="post-author vcard"><span class="fn"><br/></span></span><br/><span class="post-author vcard"><span class="fn">OK, thats it for the moment, look for the next exploit tutorial here very shortly.</span></span>