---
layout: post
title: SSL Testing Tool ssltest.pl
date: '2010-07-27T21:18:00.005+10:00'
author: Stephen Bradshaw
tags:
- ssltest
- software
modified_time: '2010-12-15T14:04:58.490+11:00'
blogger_id: tag:blogger.com,1999:blog-2318886372568084567.post-1887583659564999259
blogger_orig_url: http://www.thegreycorner.com/2010/07/ssl-testing-tool-ssltestpl.html
redirect_from: /2010/07/ssl-testing-tool-ssltestpl.html
---

<b>Update</b>: I have just updated this tool to version 0.1.1 to resolve a minor bug (thanks Gitsnik) and a few cosmetic issues.<br/><br/>I have used a number of different tools to check cipher support on SSL Servers, including <a href="http://www.blogger.com/%5Bhttp://www.foundstone.com/us/resources/proddesc/ssldigger.htm">SSLDigger</a>, <a href="http://www.packetstormsecurity.org/filedesc/sslthing.html">sslthing</a>, <a href="http://blog.techstacks.com/cryptonark.html">Cryptonark</a>,  <a href="http://www.openssl.org/">Openssl</a> and even a few web based solutions.  Each tool has its good and bad points, but recently when trying to confirm that a particular badly behaved reverse proxy was compliant with <a href="http://www.dsd.gov.au/library/infosec/ism.html">DSD ISM</a> crypto standards I ran into some problems.  The reverse proxy I was attempting to test was not correctly responding to or closing SSLv2 and TLSv1 sessions, causing a number of the tools that I commonly use to freeze up.<br/><br/><a href="http://blog.techstacks.com/cryptonark.html">Cryptonark</a> was able to run against the proxy without freezing up, due to its ability to timeout sessions, but it still wasn't providing the right results due to the fact that it only tests SSLv2 and TLSv1, but not SSLv3 - the only protocol that happened to work on this particular system.  The tool is written in Perl however, so I consequently decided to quickly modify it to test SSLv3 as well.<br/><br/>But what started off as a quick modification, soon turned into a complete rewrite, as I rapidly came up with a list of additional features I wanted in addition to the SSLv3 support - optional verbose output (such as listing unsupported ciphers, plus connection attempts), colour highlighting for DSD ISM compliance as well as PCI-DSS, control over timeout settings, the ability to individually test protocols, more detail in the explanatory text for each cipher, greppable compliance status for each cipher, etc.  I have essentially reused the essential design concepts of the Cryptonark tool (including colour coding output, use of IO::Socket::SSL to make SSL connections, documenting supported ciphers within the tool, checking supported ciphers against a compliance standard), but have completely rewritten the code from scratch to clean it up, reduce repetition and dependence on additional perl modules, and ease implementation of the new features.<br/><br/>So now the tool is complete, it includes all those additional features I wanted, and it works very nicely against that badly behaving reverse proxy that started this whole thing.<br/><br/>I have decided to make the tool available here, first of all so I can easily get to a copy when needed, and also just in case anyone else finds it useful.  Until I can think of something better, I'm releasing this under the imaginative name of ssltest.pl - so called because the tool is used to test ssl.<br/><br/>Here is a listing of the help:<br/><blockquote style='font-family: "Courier New",Courier,monospace;'>lupin@lion:~$ ssltest.pl<br/>ssltest 0.1.1<br/>grey-corner.blogspot.com<br/><br/>Tests the provided SSL host to determine supported SSL protocols and ciphers.<br/>Originally based on Cryptonark by Chris Mahns.<br/><br/>USAGE:<br/><br/>/home/lupin/bin/ssltest.pl [options] host port<br/>/home/lupin/bin/ssltest.pl [--pci|--ssl2|--ssl3|--tls1] --list<br/><br/><br/>OPTIONS:<br/><br/>        -v|--verbose    Verbosity level. Use once to also list tested<br/>                        ciphers that are not enabled on the target host.<br/>                        Use twice to also show when host connection<br/>                        attempts are made.<br/><br/>        -r|--ssl2       Performs cipher tests for the sslv2 protocol.<br/>                        Default is all protocols (ssl2, ssl3, tls1).<br/><br/>        -s|--ssl3       Performs cipher tests for the sslv3 protocol.<br/>                        Default is all protocols (ssl2, ssl3, tls1).<br/><br/>        -t|--tls1       Performs cipher tests for the tlsv1 protocol.<br/>                        Default is all protocols (ssl2, ssl3, tls1).<br/><br/>        -x|--timeout    Sets timeout value in seconds for connections.<br/>                        Default 4.  Lower value for hosts that may not<br/>                        properly close connections when an unsupported<br/>                        protocol request is attempted.  Raise value for<br/>                        slow links/hosts.<br/><br/>        -i|--ism        Marks enabled ciphers that are compliant with the<br/>                        DSD ISMs standards for in-transit protection of<br/>                        IN-CONFIDENCE information (ISM Sep 2009).  Default<br/>                        compliance standard used (as opposed to PCI).<br/><br/>        -p|--pci        Marks enabled ciphers that are compliant with<br/>                        PCI-DSS standards.  Provided as an alternate<br/>                        compliance standard to the DSD ISM.<br/><br/>        -g|--grep       Outputs in a semicolon ";" separated greppable<br/>                        format, adds text for compliance status.  Use<br/>                        when you need to write output to a text file and<br/>                        you want compliance status to be included in<br/>                        text format instead of just being repressnted by<br/>                        terminal colour.<br/><br/>        -l|--list       Lists ciphers checked by this tool and exits,<br/>                        with output colour coded to indicate compliance<br/>                        status with the selected standard (pci or ism).<br/>                        Host and port values do not need to be provided<br/>                        when using this option, as no host connection is<br/>                        made.  Purely informational, so you can see what<br/>                        ciphers are tested for, and which are deemed to be<br/>                        compliant with the various standards.<br/><br/><br/>If one or more protocol/s (SSLV2, SSLV3, TLSV1) are not specifically enabled,<br/>tests for all protocols will be performed.  If you know that a host does not<br/>support certain protocols (or does not properly close connection attempts made<br/>using particular protocols) you can only include tests for the protocols you<br/>are interested in to speed up the test.  If no compliance standard is<br/>specifically enabled, or if more than one standard is enabled, the default<br/>is to use the DSD ISM.<br/><br/><br/>EXAMPLES:<br/><br/>/home/lupin/bin/ssltest.pl -vvrsi test.example.com 443<br/><br/>Performs testing on host test.example.com port 443, using the sslv3 protocol<br/>(-s), and sslv2 protocol (-r), matches responses against the cipher<br/>requirements in the ISM (-i) and provides double verbose output (-vv) where<br/>ciphers unsupported by the destination host and connection attempts are printed<br/>to screen.<br/><br/>/home/lupin/bin/ssltest.pl --list<br/><br/>Provides a list of all ciphers supported by the tool, colour coded to indicate<br/>which ones are considered to be compliant with the ISM.  Add the --pci switch<br/>to colour code listed ciphers for PCI compliance instead, or supply the --ssl2,<br/>--ssl3 or --tls1 switches to only list ciphers appropriate to those protocols.</blockquote><br/>Here is the tool in action, performing a test of the SSL ciphers supported by www.google.com<br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>lupin@lion:~$ ssltest.pl www.google.com 443<br/>Checking for Supported SSLv2 Ciphers on www.google.com:443...<br/>Checking for Supported SSLv3 Ciphers on www.google.com:443...<br/><span style="color: lime;">   DES-CBC3-SHA, 3DES 168 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span><br/><span style="color: lime;">   AES128-SHA, AES 128 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span><br/><span style="color: lime;">   AES256-SHA, AES 256 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span><br/><span style="color: red;">   RC4-MD5, RC4 128 bits, RSA Authentication, MD5 MAC, RSA Key Exchange</span><br/><span style="color: red;">   RC4-SHA, RC4 128 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span><br/>Checking for Supported TLSv1 Ciphers on www.google.com:443...<br/>  <span style="color: #274e13;"> <span style="color: lime;">DES-CBC3-SHA, 3DES 168 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span></span><br/><span style="color: lime;">   AES128-SHA, AES 128 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span><br/><span style="color: lime;">   AES256-SHA, AES 256 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span><br/><span style="color: red;">   RC4-MD5, RC4 128 bits, RSA Authentication, MD5 MAC, RSA Key Exchange</span><br/><span style="color: red;">   RC4-SHA, RC4 128 bits, RSA Authentication, SHA1 MAC, RSA Key Exchange</span></blockquote><br/>I have reproduced above the colour coding the tool uses, a really helpful feature "borrowed" from Cryptonark, showing which ciphers are considered to be supported under the DSD ISM.  You can see from the above output that no SSlv2 ciphers are supported, and that some ciphers are coloured green, indicating that they are compliant with the selected standard of the ISM, and others are coloured red, indicating they are not.<br/><br/>Some ideas I have for the next revision of this tool are to have it verify that the hostname matches the common name on the certificate, to confirm the certificate has not expired, and possibly also to verify that the certificate is signed by a trusted certificate authority and has not been revoked.<br/><br/>You can download version the tool from Github:<br/><ul><li><a href="https://github.com/stephenbradshaw/ssltest">ssltest</a></li></ul><br/>Let me know if you try this tool out and find it useful.