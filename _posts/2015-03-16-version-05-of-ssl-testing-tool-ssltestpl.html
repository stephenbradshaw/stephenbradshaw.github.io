---
layout: post
title: Version 0.5 of SSL Testing Tool ssltest.pl
date: '2015-03-16T15:54:00.000+11:00'
author: Stephen Bradshaw
tags:
- ssltest
- software
modified_time: '2015-03-16T15:54:39.365+11:00'
blogger_id: tag:blogger.com,1999:blog-2318886372568084567.post-4972869664554067323
blogger_orig_url: http://www.thegreycorner.com/2015/03/version-05-of-ssl-testing-tool-ssltestpl.html
redirect_from: /2015/03/version-05-of-ssl-testing-tool-ssltestpl.html
---

I recently received an email asking me whether ssltest.pl, something I initially wrote a few years ago and have recently completely ignored, supported TLS versions 1.1 and 1.2.  Well, it didn't, but after having a look at the code it turns out that it was easy enough to add support for these versions of the protocol.  Due to this, I've released a new version of the tool, with this, and a few other changes.<br/><br/>Here's the changes:<br/><ul><li><span style="font-family: Times, 'Times New Roman', serif;">Added support for scanning versions 1.1. and 1.2 of TLS</span></li><li><span style="font-family: Times, Times New Roman, serif;">Updated compliance checks for PCI DSS 3.0 (I'm about 90% sure this is accurate and reflective of the most paranoid interpretation of the rules and other guidance). Running the tool with --list -p will list the ciphers and show you which are I believe are approved and which are not - let me know if you think I've been overly strict.</span></li><li><span style="font-family: Times, Times New Roman, serif;">Updated compliance checks for ISM 2014, including a new Yellow color for ciphers that meet the mandatory (MUST) ISM standards, but don't meet the SHOULD standards (as it turns out this is quite a few of them).  The usual Green is used for ciphers that meet both.  Use --list to list all supported ciphers that the tool can check for and show which ones are which. Â The code has comments describing the things that are being checked for, if you're interested.</span></li><li><span style="font-family: Times, Times New Roman, serif;">Updated cipher list for the newer versions of OpenSSL. The new list is quite a bit bigger than that of the previous version, but specific support depends on your underlying OpenSSL library.</span></li><li><span style="font-family: Times, Times New Roman, serif;">Removal of by default peer certificate verification, and an option to turn this on if you wish (the tool is designed to check supported ciphers, not certificates)</span></li><li><span style="font-family: Times, Times New Roman, serif;">Updated the help</span></li></ul>Now, something to note if you are running this on recent Ubuntu systems is that some of the underlying libraries used to make the SSL/TLS connections, including libssl and Net::SSLeay, both disable SSLv2 support. Most likely due to its horrible insecurity.  This means that SSLv2 cipher checks using these libraries will silently fail in ssltest.pl, resulting in false negatives.<br/><br/>Chris Mahns, from whom I <strike>ripped off</strike> borrowed the initial codebase and idea for ssltest.pl has posted some solutions to this on his blog.  The following are for Ubuntu 13.04, but can be largely run with small modifications on Ubuntu 14.04, which is the platform I was using for testing.<br/><br/>Here's how you fix OpenSSL.  On 14.04 you don't need to worry about the TLSv1.2 client bit, and the version of OpenSSL will be different, but otherwise the process is identical:<br/><br/><a href="http://www.techstacks.com/howto/enable-sslv2-and-tlsv12-in-openssl-101c-on-ubuntu-1304.html">http://www.techstacks.com/howto/enable-sslv2-and-tlsv12-in-openssl-101c-on-ubuntu-1304.html</a><br/><br/>  Here's what you do with Net::SSLeay. I modified the below slightly by making the source change in the Ubuntu package for Net::SSLeay (libnet-ssleay-perl) instead of the source from the libraries authors, then I rebuilt the .deb file and installed it.  In essence, I used a combination of this process plus the Debian package rebuilding steps in the previous link.  I did not need to reinstall IO::Socket::SSL, which was installed using the libio-socket-ssl-perl Ubuntu package.<br/><br/><a href="http://www.techstacks.com/howto/enable-sslv2-methods-in-netssleay.html">http://www.techstacks.com/howto/enable-sslv2-methods-in-netssleay.html</a><br/><br/>Now, if you're running a amd64 version of Ubuntu, you may find that when you build these packages, it creates a dependency for libc6-amd64 instead of just libc6.  This will create dependency problems when you try and install the package, because there is no amd64 version of libc6-amd64 (its a multiarch thing).  I was too lazy to figure out the underlying cause for this, so to fix it I just modified the recreated .deb files to change this dependency back to libc6 using the following method.<br/><br/><a href="https://thedarkmaster.wordpress.com/2008/05/24/how-to-create-manipulate-a-deb-file-of-a-compiled-application/">https://thedarkmaster.wordpress.com/2008/05/24/how-to-create-manipulate-a-deb-file-of-a-compiled-application/</a><br/><br/>Grab the new ssltest.pl from <a href="https://sites.google.com/site/lupingreycorner/ssltest.pl">here</a>.