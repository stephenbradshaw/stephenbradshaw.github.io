---
layout: post
title: Running Regripper on Linux
date: '2010-04-25T15:57:00.007+10:00'
author: Stephen Bradshaw
tags:
- incident response
modified_time: '2010-08-30T11:54:21.357+10:00'
blogger_id: tag:blogger.com,1999:blog-2318886372568084567.post-5254522895345945130
blogger_orig_url: http://www.thegreycorner.com/2010/04/running-regripper-on-linux.html
redirect_from: /2010/04/running-regripper-on-linux.html
---

I have been using <a href="http://windowsir.blogspot.com/">Harlan Carvey's</a> excellent <a href="http://www.regripper.net/">RegRipper</a> tool for a while now to analyse Windows registry hive files as part of incident investigations, and since I do the majority of my investigations from Linux systems I thought I'd share here the process I use to run RegRipper from Linux.<br/><br/>I am aware that a <a href="http://brainstretching.blogspot.com/2008/10/linux-e-regripper.html">Linux version of RegRipper</a> has been created but at the time that I checked it was not available to download from RapidShare.  In addition,  since the process of getting the Windows version to run on Linux is so easy, this is usually the method I follow.<br/><br/>I am doing the following on Ubuntu 9.10, but these instructions should work on the majority of Linux installations.  The majority of these commands to install RegRipper need to be run as root, so I am using a root shell, opened on Ubuntu via the command "sudo -s".<br/><br/>First we need to install the <a href="http://cpansearch.perl.org/src/JMACFARLA/Parse-Win32Registry-0.30/README">Parse::Win32Registry</a> perl module, which RegRipper uses to parse the registry hive files.  Grab it from CPAN like so. <br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>root@lion:~# perl -MCPAN -e 'install Parse::Win32Registry'</blockquote><br/>Now we need to create a directory for RegRipper to run from.  I like to put it in its own directory under /opt, but you can put it wherever you wish.  Create the directory and change to it.<br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>root@lion:~# mkdir -p /opt/regripper<br/>root@lion:~# cd /opt/regripper</blockquote><br/>Now we download the RegRipper program itself.  The command below downloads the latest available version at the time of writing.  To check for later versions, go <a href="http://www.regripper.net/">here</a> and check the Downloads area.<br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# wget http://regripper.net/RR/RegRipper/rr_20080909.zip</blockquote><br/>Unzip RegRipper<br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# unzip rr_20080909.zip</blockquote><br/>Convert to Unix line endings and make the rip.pl script executable<br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# perl -pi -e 's/\r\n/\n/g' rip.pl<br/>root@lion:/opt/regripper# chmod +x rip.pl</blockquote><br/>Exit the first line of rip.pl to use your systems perl interpreter to run rip.pl<br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# which perl | sed 's/\//\\\//g' &gt; /tmp/perlloc &amp;&amp; sed -i "s/ c:\\\\perl\\\\bin\\\\perl.exe/`cat /tmp/perlloc`/" rip.pl</blockquote><br/>Add/Modify a few commands to allow the RegRipper plugins directory to be found:<br/><br/><blockquote> <span style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# echo $PWD | sed 's/\//\\\//g' &gt; /tmp/pwd &amp;&amp; sed -i "s/use Getopt::Long;/use Getopt::Long;\nuse lib \'`cat /tmp/pwd`\/\';\n/" rip.pl</span><br/><div style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# sed -i "s/plugindir = \"plugins\\\\\\\\/plugindir = \"`cat /tmp/pwd`\/plugins\//" rip.pl </div><div style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# sed -i 's/require "plugins\\\\".$plugins{$i}."\\.pl";/require "plugins\/".$plugins{$i}."\\.pl";/' rip.pl</div></blockquote><br/>Now we should be able to run the rip.pl RegRipper command line interface.<br/><br/><blockquote style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# ./rip.pl <br/>Rip v.20080419 - CLI RegRipper tool    <br/>Rip [-r Reg hive file] [-f plugin file] [-p plugin module] [-l] [-h]<br/>Parse Windows Registry files, using either a single module, or a plugins file.<br/>All plugins must be located in the "plugins" directory; default plugins file <br/>used if no other filename given is "plugins\plugins".<br/><br/>  -r Reg hive file...Registry hive file to parse<br/>  -g ................Guess the hive file (experimental)<br/>  -f [plugin file]...use the plugin file (default: plugins\plugins)<br/>  -p plugin module...use only this module<br/>  -l ................list all plugins<br/>  -c ................Output list in CSV format (use with -l)<br/>  -h.................Help (print this information)<br/>  <br/>Ex: C:\&gt;rr -r c:\case\system -f system<br/>    C:\&gt;rr -r c:\case\ntuser.dat -p userassist<br/>    C:\&gt;rr -l -c<br/><br/>All output goes to STDOUT; use redirection (ie, &gt; or &gt;&gt;) to output to a file.<br/>  <br/>copyright 2008 H. Carvey</blockquote><br/>And we can run it against one of the Registry hive files from my Windows system volume mounted at /media/sda2<br/><br/><blockquote><div style='font-family: "Courier New",Courier,monospace;'>root@lion:/opt/regripper# ./rip.pl -r /media/sda2/Windows/System32/config/SAM -f sam</div><div style='font-family: "Courier New",Courier,monospace;'>Parsed Plugins file.</div><div style='font-family: "Courier New",Courier,monospace;'>Launching samparse v.20080415</div><div style='font-family: "Courier New",Courier,monospace;'><br/></div><div style='font-family: "Courier New",Courier,monospace;'>User Information</div><div style='font-family: "Courier New",Courier,monospace;'>-------------------------</div><div style='font-family: "Courier New",Courier,monospace;'>Username        : Administrator [500]</div><div style='font-family: "Courier New",Courier,monospace;'>Full Name       : </div><div style='font-family: "Courier New",Courier,monospace;'>User Comment    : Built-in account for administering the computer/domain [SNIP]</div></blockquote><br/><br/>And thats it - happy RegRipping!<br/><br/><b>Update</b>:  Modified download path above to take into account change of location on RegRipper site.