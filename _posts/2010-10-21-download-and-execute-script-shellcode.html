---
layout: post
title: Download and Execute Script Shellcode on Windows 7
date: '2010-10-21T18:20:00.001+11:00'
author: Stephen Bradshaw
tags:
- restrictive proxies
- pentesting
- shellcode
modified_time: '2010-10-21T18:28:09.261+11:00'
blogger_id: tag:blogger.com,1999:blog-2318886372568084567.post-1525182226316849737
blogger_orig_url: http://www.thegreycorner.com/2010/10/download-and-execute-script-shellcode.html
redirect_from: /2010/10/download-and-execute-script-shellcode.html
---

I have just released a new version of my Download and Execute Script shellcode which now works on Windows 7.<br/><br/>Essentially, the previous method I was using to find the base address of kernel32 was not Windows 7 compatible, so I have now started using <a href="http://skypher.com/index.php/2009/07/22/shellcode-finding-kernel32-in-windows-7/">this method discovered by SkyLined</a>.<br/><br/>Taking into account some other "efficient-ising" I did while I was making this change, this comes in at only (IIRC) 3 bytes larger than the original.<br/><br/>I haven't tested this on anything other than Windows 7 so far, but hopefully this should still work on Windows 2000 and up.Â  If you find otherwise, let me know.<br/><br/>See the original blog post on the shellcode <a href="http://grey-corner.blogspot.com/2010/05/download-and-execute-script-shellcode.html">here</a> for more information on how to use it.<br/><br/>I still havent been bothered to enable EXITFUNC changing options in the Metasploit module, because I had no need to change this, but if anyone wants this functionality let me know and I will add it.<br/><br/>Download here:<br/><ul><li><a href="http://sites.google.com/site/lupingreycorner/descript.asm">Assembly source</a></li><li><a href="http://sites.google.com/site/lupingreycorner/download_exec_script.rb">Metasploit module</a></li></ul><br/>These new versions replace the originals.