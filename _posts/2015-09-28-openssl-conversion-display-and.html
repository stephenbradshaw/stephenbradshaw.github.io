---
layout: post
title: OpenSSL Conversion, Display and Encryption Commands for Pentesters
date: '2015-09-28T16:18:00.003+10:00'
author: Stephen Bradshaw
tags:
- pentesting
- ctf
- cryptography
modified_time: '2015-09-28T16:18:54.553+10:00'
blogger_id: tag:blogger.com,1999:blog-2318886372568084567.post-2384157004547429970
blogger_orig_url: http://www.thegreycorner.com/2015/09/openssl-conversion-display-and.html
redirect_from: /2015/09/openssl-conversion-display-and.html
---

Every time I pull out OpenSSL to perform a particular task I end up having to refer to Google or random text files on my hard drive to remind myself of the correct syntax. Consequently, I'm doing a writeup here of all of the OpenSSL commands that I make use of in various penetration tests and CTF challenges that involve encryption, mainly as a personal reference, but also in case anyone else finds this useful.<br/><br/>The following commands are sorted by category, and may be added to in the future if I find more commands that I find useful.<br/><br/><h3>Asymmetric keyfile conversion</h3>Conversion of asymmetric keys between various different storage formats. <br/><h4>DER to PEM</h4>Convert der certificate to pem format.<br/><br/><pre class="code">openssl x509 -inform der -outform pem -in certificate.crt -out certificate.pem</pre><br/><br/><h4>PEM to DER </h4>Convert pem certificate to der format.<br/><br/><pre class="code">openssl x509 -inform pem -outform der -in certificate.pem -out certificate.crt</pre><br/><h4>PEM Key and Certificate to PKCS12</h4>Convert private key and certificate to pkcs12 format.<br/><br/><pre class="code">openssl pkcs12 -export -out keys.p12 -inkey private.pem -in certificate.pem</pre><br/><h3>Displaying data from asymmetric keyfiles</h3>Displaying of informational data from various forms of asymmetric key files.<br/><h4>PKCS12 Files</h4><br/>Print nodes from a pkcs12 file.<br/><br/><pre class="code">openssl pkcs12 -in keys.p12 -nodes</pre><br/><br/><h4>Public Keys </h4> Display a variety of data from a public key.<br/><br/><pre class="code">openssl rsa -inform pem -pubin -text -noout -in publickey.pem</pre><br/>Display the modulus from a public key.<br/><br/><pre class="code">openssl rsa -inform pem -pubin -modulus -noout -in publickey.pem</pre><br/><br/><h4>Private Keys </h4><br/>Display a variety of data from a private key.<br/><br/><pre class="code">openssl rsa -inform pem -text -noout -in privatekey.pem</pre><br/>Display the modulus from a private key.<br/><br/><pre class="code">openssl rsa -inform pem -modulus -noout -in privatekey.pem</pre><br/><h4>Certificates </h4> Display a variety of data from a certificate.<br/><br/><pre class="code">openssl x509 -inform pem -text -noout -in certificate.pem</pre><br/>Display the modulus from a certificate.<br/><br/><pre class="code">openssl x509 -inform pem -modulus -noout -in certificate.pem</pre><br/><h4>Different Key Formats for Private/Public Keys and Certificates</h4>The Public/Private/Certificate commands immediately above all make use of the pem format in the file that they read.  This can be changed to 'der' or 'net' to use an alternate format.<br/><br/><h3>Encryption and decryption using asymmetric cryptography</h3>Encryption and decryption of data using asymmetric cryptography. <br/><h4>Decryption</h4><br/>Decryption using a private key.<br/><br/><pre class="code">openssl rsautl -decrypt -in encryptedfile -out decryptedfile -inkey ./privatekey.pem</pre><br/><h4>Encryption </h4> Encryption using a public key.<br/><br/><pre class="code">openssl rsautl -encrypt -pubin -in plaintextfile -out encryptedfile -inkey ./publickey.pem</pre><br/>Encryption using a certificate.<br/><br/><pre class="code">openssl rsautl -encrypt -certin -in plaintextfile -out encryptedfile -inkey ./certificate.pem</pre><br/><br/><h4>Padding Modifiers </h4><br/>These examples all assume a default padding type of PKCS 1.5. The following options can be used to try different types of padding, or none at all.<br/><br/><pre class="code">-pkcs, -oaep, -ssl, -raw</pre><br/><h3>Encryption and decryption using symmetric cryptography</h3>Encryption and decryption of data using asymmetric cryptography. <br/><h4>Encryption</h4><br/>Encrypt a file using AES in CBC mode with a keyfile.<br/><br/><pre class="code">openssl enc -aes-256-cbc -in ./plaintext.txt -out ./encrypted.bin -pass file:./passwordfile.bin</pre><br/><h4>Decryption </h4><br/>Decrypt a file using AES in CBC mode with a keyfile.<br/><br/><pre class="code">openssl enc -d -aes-256-cbc -in ./encrypted.bin -out ./plaintext.txt -pass file:./passwordfile.bin</pre><br/><h4>Encryption modifiers and alternate algorithms</h4> The following switches can be used to modify the way the encryption process occurs.<br/><br/><pre class="code">-salt adds a salt to the file <br/>-base64 base64 encodes/decodes depending on encryption mode<br/></pre><br/>There are also a wide variety of other encryption algorithms and cipher modes that can be used, which can be listed by the following. <br/><br/><pre class="code">openssl enc -h</pre>